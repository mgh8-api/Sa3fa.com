server {
  listen 80;
  listen 443 ssl;
  server_name sa3fa.com www.sa3fa.com;

  # SSL configuration (you'll need to add your SSL certificate paths)
  ssl_certificate /etc/letsencrypt/live/sa3fa.com/fullchain.pem;
  ssl_certificate_key /etc/letsencrypt/live/sa3fa.com/privkey.pem;
  
  # SSL settings
  ssl_protocols TLSv1.2 TLSv1.3;
  ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384;
  ssl_prefer_server_ciphers off;

  root /usr/share/nginx/html;
  index index.html;

  # SPA fallback so /anything routes render your React app (NotFound, etc.)
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Strong caching for hashed assets from Vite build
  location /assets/ {
    try_files $uri =404;
    add_header Cache-Control "public, max-age=31536000, immutable";
  }

  # Redirect HTTP to HTTPS
  if ($scheme != "https") {
    return 301 https://$server_name$request_uri;
  }
}
